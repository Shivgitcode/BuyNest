name: build and deploy

on:
  push:
    branches:
        - master

jobs:
    build:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout repo
              uses: actions/checkout@master
            - name: use nodejs
              uses: actions/setup-node@v3
              with:
                node-version: "18"
            - name: install dependencies
              run: npm install
              working-directory: client
            - name: building the project
              run: npm run build
              working-directory: client

            - name: Archive production artifact
              uses: actions/upload-artifact@master
              with:
                name: build
                path: client/build
    deploy:
        needs: build
        runs-on: ubuntu-latest
        steps:
            - name: Checkout repo
              uses: actions/checkout@master
            - name: Download Artifact
              uses: actions/download-artifact@master
              with:
                name: build
                path: build
            - name: Deploy to Firebase
              uses: w9jds/firebase-action@master
              with:
                args: deploy --only hosting
              env:
                FIREBASE_TOKEN: ${{secrets.FIREBASE_TOKEN}} 
